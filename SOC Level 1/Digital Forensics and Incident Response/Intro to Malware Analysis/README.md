# TryHackMe Room: Intro to Malware Analysis

This room was a foundational introduction to the world of malware analysis. I learned the core concepts of static and dynamic analysis and then applied them to a practical example. This involved using command-line tools to examine a malware sample and then leveraging online sandboxes to observe its behavior.

---

## Section: Malware Analysis

### Task 1: Which team uses malware analysis to look for IOCs and hunt for malware in a network?

The room's description provided a direct answer to this question. Malware analysis is used by Threat Hunt teams to identify Indicators of Compromise (IOCs) that they then use to proactively search for threats within a network.

---

## Section: Techniques of Malware Analysis

### Task 1: Which technique is used for analyzing malware without executing it?

The answer is Static Analysis. This technique involves examining the malware's properties, such as its hash, strings, and headers, without running the file.

### Task 2: Which technique is used for analyzing malware by executing it and observing its behavior in a controlled environment?

This technique is called Dynamic Analysis. It involves running the malware in a safe, isolated environment (like a sandbox) to observe its actions and effects on the system.

---

## Section: Basic Static Analysis

### Task 1: In the attached VM, there is a sample named 'redline' in the Desktop/Samples directory. What is the md5sum of this sample?

I used the attached VM for this task, as it was already configured with the necessary tools and files. I navigated to the Desktop/Samples directory and used the md5sum command to get the hash of the redline sample.

md5sum redline

[Screenshot 01: MD5 hash of the sample](./screenshots/01-md5-hash.png)

### Task 2: What is the creation time of this sample?

To find the creation time, I used the MD5 hash from the previous task and checked the file on VirusTotal. The creation time was listed in the Details section of the report.

[Screenshot 02: VirusTotal creation time](./screenshots/02-vt-creation-time.png)

---

## Section: The PE File Header

### Task 1: In the attached VM, there is a sample named 'redline' in the directory Desktop/Samples. What is the entropy of the .text section of this sample?

I used the pecheck tool to analyze the file's header and sections. The output provided the entropy value for each section, including the .text section.

pecheck redline

[Screenshot 03: .text section entropy](./screenshots/03-pecheck-entropy.png)

### Task 2: The sample named 'redline' has five sections. .text, .rdata, .data and .rsrc are four of them. What is the name of the fifth section?

The output from the pecheck command also listed all the sections in the PE file. From this list, I could identify the fifth section, which was .ndata.

### Task 3: From which dll file does the sample named 'redline' import the RegOpenKeyExW function?

To find the specific DLL that imports the RegOpenKeyExW function, I used pecheck and piped the output to grep to filter for the function name.

pecheck redline | grep -i "regopenkey"

[Screenshot 04: Imported DLL function](./screenshots/04-imported-dll.png)

---

## Section: Basic Dynamic Analysis

### Task 1: In the process tree, which is the first process launched when the sample is launched?

I took the MD5 hash of the sample and searched for a report on Hybrid Analysis. In the analysis report, I navigated to the Process Tree to see the processes launched by the sample. The first one was the answer.

[Screenshot 05: Process tree on Hybrid Analysis](./screenshots/05-process-tree.png)

### Task 2: In the process tree, there are two Windows utilities utilized by the malware to perform its activities. What are the names of the two utilities? (Format: utility1.exe and utility2.exe)

By examining the process tree in the Hybrid Analysis report, I identified two common Windows utilities that the malware used: cmd.exe and powershell.exe.

---

## Section: Anti-analysis Techniques

### Task 1: Which of the techniques discussed above is used to bypass static analysis?

The technique used to bypass static analysis is packing. This involves compressing or encrypting the malware's code to make it difficult for analysts to understand without executing it.

### Task 2: Which technique discussed above is used to time out a sandbox?

A common technique to time out a sandbox is long sleep calls. The malware waits for a prolonged period, hoping that the automated analysis will time out before it starts its malicious activity.

---

## Summary
This room provided a solid foundation in malware analysis. I learned to differentiate between static and dynamic analysis and apply these techniques to a real-world sample. I also gained experience using:

Command-line tools (md5sum, pecheck) to perform static analysis.

Online sandboxes (VirusTotal, Hybrid Analysis) to perform dynamic analysis and gain external intelligence.

File and process analysis to understand a malware's PE header, imports, and behavioral patterns.

Knowledge of anti-analysis techniques that malware uses to evade detection.

This room was a great starting point for anyone interested in the field of malware reverse engineering.